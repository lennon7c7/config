Index: thinkphp/library/think/db/Connection.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/db/Connection.php b/thinkphp/library/think/db/Connection.php
--- a/thinkphp/library/think/db/Connection.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/db/Connection.php	(date 1676537293839)
@@ -345,6 +345,13 @@
      */
     public function query($sql, $bind = [], $master = false, $pdo = false)
     {
+        // lennon todo find sql call stack
+        $haystack = $sql;
+        $needle = 'policies';
+        if (str_contains($haystack, $needle)) {
+//            throw new Exception('find sql call stack');
+        }
+
         $this->initConnect($master);
         if (!$this->linkID) {
             return false;
Index: thinkphp/library/think/db/Query.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/db/Query.php b/thinkphp/library/think/db/Query.php
--- a/thinkphp/library/think/db/Query.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/db/Query.php	(date 1676537293866)
@@ -2474,7 +2474,7 @@
      * 查找记录
      * @access public
      * @param array|string|Query|\Closure $data
-     * @return Collection|false|\PDOStatement|string
+     * @return Collection|false|\PDOStatement|string|array
      * @throws DbException
      * @throws ModelNotFoundException
      * @throws DataNotFoundException
@@ -2621,7 +2621,7 @@
      * 查找单条记录
      * @access public
      * @param array|string|Query|\Closure $data
-     * @return array|false|\PDOStatement|string|Model
+     * @return array|false|\PDOStatement|string|Model|self
      * @throws DbException
      * @throws ModelNotFoundException
      * @throws DataNotFoundException
Index: application/common/behavior/Common.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/common/behavior/Common.php b/application/common/behavior/Common.php
--- a/application/common/behavior/Common.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/common/behavior/Common.php	(date 1676537293852)
@@ -53,6 +53,10 @@
         if (Config::get('app_debug')) {
             // 如果是调试模式将version置为当前的时间戳可避免缓存
             //Config::set('site.version', time());
+
+            // lennon todo 将version置为当前的时间戳可避免缓存
+            Config::set('site.version', date('Y-m-d H:i:s'));
+
             // 如果是开发模式那么将异常模板修改成官方的
             Config::set('exception_tmpl', THINK_PATH . 'tpl' . DS . 'think_exception.tpl');
         }
Index: thinkphp/library/think/Log.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/Log.php b/thinkphp/library/think/Log.php
--- a/thinkphp/library/think/Log.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/Log.php	(date 1676537293873)
@@ -17,12 +17,13 @@
  * Class Log
  * @package think
  *
- * @method static void log($msg) 记录一般日志
- * @method static void error($msg) 记录错误日志
- * @method static void info($msg) 记录一般信息日志
- * @method static void sql($msg) 记录 SQL 查询日志
- * @method static void notice($msg) 记录提示日志
- * @method static void alert($msg) 记录报警日志
+ * @method void log($msg) static 记录一般日志
+ * @method void error($msg) static 记录错误日志
+ * @method void info($msg) static 记录一般信息日志
+ * @method void sql($msg) static 记录 SQL 查询日志
+ * @method void notice($msg) static 记录提示日志
+ * @method void alert($msg) static 记录报警日志
+ * @method void debug($msg) static 记录调试日志
  */
 class Log
 {
@@ -233,5 +234,4 @@
             call_user_func_array('\\think\\Log::record', $args);
         }
     }
-
 }
Index: addons/listener/listener/Product.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/addons/listener/listener/Product.php b/addons/listener/listener/Product.php
--- a/addons/listener/listener/Product.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/addons/listener/listener/Product.php	(date 1676537293882)
@@ -22,6 +22,14 @@
 
         // 从config.php取app_env配置
         $app_env = Config::get('app_env');
+
+
+        // lennon todo test
+        \think\Log::debug($app_env);
+        $app_env = 'prod';
+        \think\Log::debug(method_exists('\addons\nft\Hook', 'start'));
+
+
         if ($app_env === 'prod') {
             if (method_exists('\addons\nft\Hook', 'start')) {
                 // 提前埋点
Index: application/index/controller/Checkout.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/index/controller/Checkout.php b/application/index/controller/Checkout.php
--- a/application/index/controller/Checkout.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/index/controller/Checkout.php	(date 1676537293897)
@@ -77,7 +77,7 @@
         }catch (Exception $exception){
             Db::rollback();
             LogLib::insert(__METHOD__,LogLib::LEVEL_ERROR,$exception);
-            return $this->error($exception->getMessage());
+            return $this->error($exception->getMessage(), '', $exception->getTrace());
         }
     }
 
Index: composer.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/composer.json b/composer.json
--- a/composer.json	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/composer.json	(date 1676537293905)
@@ -15,7 +15,7 @@
         }
     ],
     "require": {
-        "php": ">=7.1.0",
+        "php": ">=7.4.0",
         "topthink/framework": "dev-master",
         "topthink/think-captcha": "^1.0",
         "topthink/think-installer": "^1.0.14",
@@ -29,6 +29,7 @@
         "ext-json": "*",
         "ext-curl": "*",
         "ext-pdo": "*",
+        "ext-bcmath": "*",
         "txthinking/mailer": "^2.0",
         "zoujingli/ip2region": "^1.0",
         "topthink/think-migration": "1.*",
Index: public/assets/js/backend/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/public/assets/js/backend/index.js b/public/assets/js/backend/index.js
--- a/public/assets/js/backend/index.js	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/public/assets/js/backend/index.js	(date 1676537293917)
@@ -80,7 +80,7 @@
                 $('.maskLayer').css({'display':'none'})
                 $('.SecondaryDetermination').css({'display':'none'})
             }
-            $('#CancelBtn').click(function(){ModelHider()})  
+            $('#CancelBtn').click(function(){ModelHider()})
             $('#SureBtnD').click(function(){
                 $.ajax({
                     url: 'ajax/wipecache',
@@ -121,7 +121,7 @@
             })
 
             $('.SecondaryDetermination').click(function () {
-                
+
                 ModelHider()
             })
             $(document).on('click', "#clear_Cache", function () {
@@ -241,6 +241,9 @@
             //绑定tabs事件,如果需要点击强制刷新iframe,则请将iframeForceRefresh置为true,iframeForceRefreshTable只强制刷新表格
             nav.addtabs({iframeHeight: "100%", iframeForceRefresh: false, iframeForceRefreshTable: true, nav: nav});
 
+            // lennon todo fast refresh
+            // nav.addtabs({iframeHeight: "100%", iframeForceRefresh: true, iframeForceRefreshTable: true, nav: nav});
+
             if ($("ul.sidebar-menu li.active a").size() > 0) {
                 $("ul.sidebar-menu li.active a").trigger("click");
             } else {
Index: addons/job/job/BaseJob.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/addons/job/job/BaseJob.php b/addons/job/job/BaseJob.php
--- a/addons/job/job/BaseJob.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/addons/job/job/BaseJob.php	(date 1676537293926)
@@ -16,7 +16,7 @@
     public function failed($data)
     {
         // 记录日志
-        Log::insert(__METHOD__,'queue-failed',$data);
-        \think\Log::write('队列任务执行失败，错误信息：' . json_encode($data));
+//        Log::insert(__METHOD__,'queue-failed',$data);
+        \think\Log::error('队列任务执行失败，错误信息：' . json_encode($data));
     }
 }
Index: .env
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.env b/.env
new file mode 100644
--- /dev/null	(date 1676537294194)
+++ b/.env	(date 1676537294194)
@@ -0,0 +1,34 @@
+[app]
+debug = false
+debug = true
+trace = true
+trace = false
+app_env = prod
+app_env = local
+admin_web_token = NVLeyAa6cRpdrujFvsY8zHZi4nX9lBog
+docker_name = shoppaas_1648460923401_web
+api_url = http://admin.maoshishop.com
+home_url = http://192.168.1.222:9060
+
+
+[database]
+hostname = mysql
+database = maoshishop
+username = root
+password = root
+hostport = 3306
+prefix =
+debug = false
+debug = true
+
+[redis]
+host = 127.0.0.1
+port = 6379
+password =
+
+[payment]
+environment = sandbox
+
+[error_report]
+push_url_order      = IGNORE
+push_url_exception  = IGNORE
Index: addons/listener/listener/PlatformButton.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/addons/listener/listener/PlatformButton.php b/addons/listener/listener/PlatformButton.php
--- a/addons/listener/listener/PlatformButton.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/addons/listener/listener/PlatformButton.php	(date 1676537293937)
@@ -52,6 +52,14 @@
 
             // 从config.php取app_env配置
             $app_env = Config::get('app_env');
+
+
+            // lennon todo test
+            \think\Log::debug($app_env);
+            $app_env = 'prod';
+            \think\Log::debug(method_exists('\addons\nft\Hook', 'productViewAddToCartButton'));
+
+
             if ($app_env === 'prod') {
                 if (method_exists('\addons\nft\Hook', 'productViewAddToCartButton')) {
                     // 提前埋点
Index: application/admin/command/Version.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/command/Version.php b/application/admin/command/Version.php
new file mode 100644
--- /dev/null	(date 1676537294132)
+++ b/application/admin/command/Version.php	(date 1676537294132)
@@ -0,0 +1,117 @@
+<?php
+
+namespace app\admin\command;
+
+use PDO;
+use PDOException;
+use think\Config;
+use think\console\Command;
+use think\console\Input;
+use think\console\input\Option;
+use think\console\Output;
+use think\Db;
+use think\Exception;
+
+/**
+ * 快捷更新版本号
+ * 删除所有旧的
+ * Class Version
+ * @package app\admin\command
+ */
+class Version extends Command
+{
+    protected $model = null;
+    /**
+     * @var \think\View 视图类实例
+     */
+    protected $view;
+
+    /**
+     * @var \think\Request Request 实例
+     */
+    protected $request;
+
+    protected function configure()
+    {
+        $this
+            ->setName('version')
+            ->addOption('delete', 'd', Option::VALUE_OPTIONAL, 'delete old file', '')
+            ->setDescription('update version config');
+    }
+
+    /**
+     * 命令行安装
+     */
+    protected function execute(Input $input, Output $output)
+    {
+        $delete = $input->getOption('delete');
+
+        $file_dir = APP_PATH . '../database/migrations/';
+        $file_name_old = '';
+        foreach (scandir($file_dir, SCANDIR_SORT_DESCENDING) as $value) {
+            if (!str_contains($value, '_update_config_version.php')) {
+                continue;
+            }
+
+            if (empty($file_name_old)) {
+                $file_name_old = $value;
+            } else {
+                unlink($file_dir . $value);
+            }
+        }
+
+        if (empty($file_name_old)) {
+            $output->error('empty $file_name_old');
+            return;
+        }
+
+        $file_content = file_get_contents($file_dir . $file_name_old);
+        preg_match('/\d+.\d+.\d+/', $file_content, $matches);
+
+        $version_old = '';
+        if (!empty($matches[0])) {
+            $version_old = $matches[0];
+        }
+
+        $version_array = explode('.', $version_old);
+        $version_z = array_pop($version_array);
+        $version_z++;
+        $version_array[] = $version_z;
+        $version_new = implode('.', $version_array);
+
+        $file_content = str_replace($version_old, $version_new, $file_content);
+
+//        unlink($file_dir . $file_name_old);
+        $file_name_new = date('YmdHis') . '_update_config_version.php';
+//        $flag = file_put_contents($file_dir . $file_name_new, $file_content);
+//        if (!$flag) {
+//            $output->error('error file_put_contents');
+//            return;
+//        }
+
+        $flag = file_put_contents($file_dir . $file_name_old, $file_content);
+        if (!$flag) {
+            $output->error('file_put_contents');
+            return;
+        }
+
+        $flag = rename($file_dir . $file_name_old, $file_dir . $file_name_new);
+        if (!$flag) {
+            $output->error('rename');
+            return;
+        }
+
+//        if ($delete) {
+//            unlink($file_dir . $file_name_old);
+//        }
+
+        $shell = "git add -A  --ignore-errors -- {$file_dir}{$file_name_new} 2>&1";
+        exec($shell, $out);
+        if (!empty($out[0])) {
+            $output->error($out[0]);
+            return;
+        }
+
+        $output->info('Update version config success');
+    }
+}
Index: thinkphp/library/think/exception/Handle.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/exception/Handle.php b/thinkphp/library/think/exception/Handle.php
--- a/thinkphp/library/think/exception/Handle.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/exception/Handle.php	(date 1676537293946)
@@ -189,6 +189,14 @@
             $statusCode = 500;
         }
         $response->code($statusCode);
+
+        // lennon todo fast debug, why postman output html?
+        if (!empty($_SERVER['HTTP_CONTENT_TYPE']) && $_SERVER['HTTP_CONTENT_TYPE'] == 'application/json') {
+            header("Content-Type: {$_SERVER['HTTP_CONTENT_TYPE']}");
+            echo json_encode($data);
+            exit();
+        }
+
         return $response;
     }
 
Index: thinkphp/library/think/exception/ErrorException.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/exception/ErrorException.php b/thinkphp/library/think/exception/ErrorException.php
--- a/thinkphp/library/think/exception/ErrorException.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/exception/ErrorException.php	(date 1676537293953)
@@ -43,6 +43,11 @@
         $this->line     = $line;
         $this->code     = 0;
 
+        // lennon todo fast debug
+        echo ($this->getMessage());
+        echo PHP_EOL;
+        echo ($this->getTraceAsString());
+
         empty($context) || $this->setData('Error Context', $context);
     }
 
Index: application/admin/command/Phpunit.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/command/Phpunit.php b/application/admin/command/Phpunit.php
new file mode 100644
--- /dev/null	(date 1676537294229)
+++ b/application/admin/command/Phpunit.php	(date 1676537294229)
@@ -0,0 +1,101 @@
+<?php
+
+namespace app\admin\command;
+
+use think\console\Command;
+use think\console\Input;
+use think\console\input\Option;
+use think\console\Output;
+use think\Request;
+use think\View;
+
+/**
+ * Run Phpunit
+ * @package app\admin\command
+ */
+class Phpunit extends Command
+{
+    protected $model = null;
+    /**
+     * @var View 视图类实例
+     */
+    protected $view;
+
+    /**
+     * @var Request Request 实例
+     */
+    protected $request;
+
+    protected function configure()
+    {
+        $this
+            ->setName('phpunit ')
+            ->addOption('site', 's', Option::VALUE_OPTIONAL, 'site', 'preview20220608')
+            ->addOption('directory', 'd', Option::VALUE_OPTIONAL, 'directory', '.')
+            ->setDescription('Run Phpunit');
+    }
+
+    /**
+     * 执行指令
+     */
+    protected function execute(Input $input, Output $output): void
+    {
+        $site = $input->getOption('site');
+        $directory = $input->getOption('directory');
+
+        $shell = "cd ./tests && chmod 777 ./phpunit";
+        exec($shell, $out);
+        if (!empty($out[0])) {
+            $output->error($out[0]);
+            return;
+        }
+
+        $shell = "cd ./tests &&";
+        $shell .= "./phpunit --bootstrap ./{$site}.php {$directory} 2>&1";
+        exec($shell, $out);
+
+        $content = implode("\n", $out);
+        $needle = 'OK';
+        if (!strstr($content, $needle)) {
+            $content = "site by {$site}\n{$content}";
+
+            $this->feishu($content);
+        }
+
+        $output->info('Run Phpunit Done');
+    }
+
+    /**
+     * 飞书机器人发送消息
+     * @param string $content
+     */
+    function feishu($content)
+    {
+        $curl = curl_init();
+
+        curl_setopt_array($curl, [
+            CURLOPT_URL => 'https://open.feishu.cn/open-apis/bot/v2/hook/5900f275-57ab-4543-8cc5-741157b3b51f',
+            CURLOPT_RETURNTRANSFER => true,
+            CURLOPT_ENCODING => '',
+            CURLOPT_MAXREDIRS => 10,
+            CURLOPT_TIMEOUT => 0,
+            CURLOPT_FOLLOWLOCATION => true,
+            CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
+            CURLOPT_CUSTOMREQUEST => 'POST',
+            CURLOPT_POSTFIELDS => json_encode([
+                'msg_type' => 'text',
+                'content' => [
+                    'text' => $content
+                ],
+            ]),
+
+            CURLOPT_HTTPHEADER => [
+                'Content-Type:  application/json'
+            ],
+        ]);
+
+        curl_exec($curl);
+
+        curl_close($curl);
+    }
+}
Index: application/admin/command/VersionNew.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/command/VersionNew.php b/application/admin/command/VersionNew.php
new file mode 100644
--- /dev/null	(date 1676537294218)
+++ b/application/admin/command/VersionNew.php	(date 1676537294218)
@@ -0,0 +1,101 @@
+<?php
+
+namespace app\admin\command;
+
+use think\console\Command;
+use think\console\Input;
+use think\console\Output;
+use think\Request;
+use think\View;
+
+/**
+ * 快捷更新版本号
+ * 保留旧的
+ * Class Version
+ * @package app\admin\command
+ */
+class VersionNew extends Command
+{
+    protected $model = null;
+    /**
+     * @var View 视图类实例
+     */
+    protected $view;
+
+    /**
+     * @var Request Request 实例
+     */
+    protected $request;
+
+    protected function configure()
+    {
+        $this
+            ->setName('new-version')
+            ->setDescription('new version config');
+    }
+
+    /**
+     * 命令行安装
+     */
+    protected function execute(Input $input, Output $output): void
+    {
+        $file_dir = APP_PATH . '../database/migrations/';
+        $file_name_old = '';
+        foreach (scandir($file_dir, SCANDIR_SORT_DESCENDING) as $value) {
+            if (!str_contains($value, '_update_config_version')) {
+                continue;
+            }
+
+            if (empty($file_name_old)) {
+                $file_name_old = $value;
+            }
+        }
+
+        if (empty($file_name_old)) {
+            $output->error('empty $file_name_old');
+            return;
+        }
+
+        $file_content = file_get_contents($file_dir . $file_name_old);
+        preg_match('/\d+.\d+.\d+/', $file_content, $matches);
+
+        $version_old = '';
+        if (!empty($matches[0])) {
+            $version_old = $matches[0];
+        }
+
+        // version increase
+        $version_array = explode('.', $version_old);
+        $version_z = array_pop($version_array);
+        $version_z++;
+        $version_array[] = $version_z;
+        $version_new = implode('.', $version_array);
+        $file_content = str_replace($version_old, $version_new, $file_content);
+
+        // class name
+        $class_old = "class UpdateConfigVersion extends";
+        $class_new = "class UpdateConfigVersion{$version_z} extends";
+        preg_match('/class UpdateConfigVersion\d+ extends/', $file_content, $matches);
+        if (!empty($matches[0])) {
+            $class_old = $matches[0];
+        }
+        $file_content = str_replace($class_old, $class_new, $file_content);
+
+        // save
+        $file_name_new = date('YmdHis') . "_update_config_version{$version_z}.php";
+        $flag = file_put_contents($file_dir . $file_name_new, $file_content);
+        if (!$flag) {
+            $output->error('error file_put_contents');
+            return;
+        }
+
+        $shell = "git add -A  --ignore-errors -- {$file_dir}{$file_name_new} 2>&1";
+        exec($shell, $out);
+        if (!empty($out[0])) {
+            $output->error($out[0]);
+            return;
+        }
+
+        $output->info('Update version config success');
+    }
+}
Index: thinkphp/library/think/exception/PDOException.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/exception/PDOException.php b/thinkphp/library/think/exception/PDOException.php
--- a/thinkphp/library/think/exception/PDOException.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/exception/PDOException.php	(date 1676597853336)
@@ -35,5 +35,11 @@
         ]);
 
         parent::__construct($exception->getMessage(), $config, $sql, $code);
+
+        // lennon todo show all message in PDOException
+        $message = $this->getTraceAsString() . PHP_EOL;
+        $message .= $sql . PHP_EOL;
+        $message .= $this->getMessage() . PHP_EOL;
+        parent::__construct($message, $config, $sql, $code);
     }
 }
Index: application/index/controller/Test.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/index/controller/Test.php b/application/index/controller/Test.php
new file mode 100644
--- /dev/null	(date 1676537294080)
+++ b/application/index/controller/Test.php	(date 1676537294080)
@@ -0,0 +1,211 @@
+<?php
+
+namespace app\index\controller;
+
+use app\admin\controller\shipping\Express;
+use app\common\controller\Frontend;
+use app\common\library\Auth;
+use app\common\library\paypal\Paypal as PayPalHelper;
+use app\common\model\Area;
+use app\common\model\Cart as CartModel;
+use app\common\model\Currency;
+use app\common\model\IpTimezone;
+use app\common\model\MarketingCoupon;
+use app\common\model\Order;
+use app\common\model\OrderAction;
+use app\common\model\Payment;
+use app\common\model\Shipping as ShippingModel;
+use app\common\model\ShippingExpress as ShippingExpressModel;
+use app\common\model\Themes;
+use app\common\model\User;
+use app\common\model\UserAddress;
+use DateTime;
+use DateTimeImmutable;
+use DateTimeInterface;
+use DateTimeZone;
+use think\Config;
+use think\Db;
+use think\db\exception\DataNotFoundException;
+use think\db\exception\ModelNotFoundException;
+use think\Exception;
+use think\exception\DbException;
+use think\Log;
+use think\Validate;
+
+class Test extends Frontend
+{
+    protected $layout = '';
+    protected $isTemplateViewPath = false;
+    protected $noNeedLogin = '*';
+    protected $noNeedRight = '*';
+
+    public function _initialize()
+    {
+//        parent::_initialize(); // TODO: Change the autogenerated stub
+//        session('e',1);
+    }
+
+    public function index()
+    {
+        $coupon = MarketingCoupon::get(22);
+        Db::transaction(function () use ($coupon) {
+            $coupon->where('quantity_total > 0');
+            $coupon->setDec('quantity_total');
+        });
+
+    }
+
+    /**
+     * 生成ip
+     */
+    public function ip()
+    {
+        set_time_limit(0);
+
+        // A类IP段
+        $min = ip2long('0.0.0.0');
+        $max = ip2long('127.255.255.255');
+        // B类IP段
+        $min = ip2long('128.0.0.0');
+        $max = ip2long('191.255.255.255');
+        // C类IP段
+        $min = ip2long('192.0.0.0');
+        $max = ip2long('223.255.255.255');
+        $ip_timezone_model = IpTimezone::order('id desc')->find();
+        if ($ip_timezone_model) {
+            $min = $ip_timezone_model->ipv4_int;
+        }
+
+        for ($i = $min; $i <= $max; $i++) {
+            $ip = long2ip($i);
+            if (!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_RES_RANGE | FILTER_FLAG_NO_PRIV_RANGE)) {
+                continue;
+            }
+
+            $ip_timezone = new IpTimezone();
+            $ip_timezone->ipv4_int = $i;
+            $ip_timezone->save();
+        }
+    }
+
+    /**
+     * 生成ip
+     */
+    public function getTimezoneOffsetByIp()
+    {
+        var_dump('System Time: ' . date('Y-m-d H:i:s'));
+//        var_dump('New York Time: ' . $this->_date(false, 'America/New_York'));
+//        var_dump('Belgrade Time: ' . $this->_date(false, 'Europe/Belgrade'));
+        var_dump('China Time: ' . $this->_date(false, 'Asia/Hong_Kong'));
+        exit();
+
+        $order = Order::get(1938);
+//        $ip = '192.0.0.1';
+        // America/Los_Angeles UTC-07:00
+//        $ip = '45.78.159.116';
+        // Asia/Tehran UTC+04:30
+//        $ip = '192.15.61.81';
+        // Asia/Hong_Kong UTC+08:00
+        $ip = '124.156.142.159';
+
+        $url = "https://worldtimeapi.org/api/ip/{$ip}";
+        $content = @file_get_contents($url);
+        if (empty($content)) {
+            return;
+        }
+
+        $content = json_decode($content, true);
+        if (empty($content['utc_offset'])) {
+            return;
+        }
+
+        if (empty($content['utc_offset'][0]) || !in_array($content['utc_offset'][0], ['+', '-'])) {
+            return;
+        }
+        $sign_offset = $content['utc_offset'][0];
+
+        $utc_offset = str_replace($content['utc_offset'][0], '', $content['utc_offset']);
+        list($hour, $minute) = explode(':', $utc_offset);
+        $minute_offset = $minute + ($hour * 60);
+
+        $default_timezone = date_default_timezone_get();
+        if ($default_timezone == 'PRC') {
+            $minute_offset += (8 * 60);
+        }
+        $utc_minute_offset = "{$sign_offset}{$minute_offset}minute";
+
+
+        var_dump($utc_minute_offset);
+        var_dump('System Time: ' . date('Y-m-d H:i:s', $order->createtime));
+        var_dump('UTC Time: ' . date('Y-m-d H:i:s', $order->createtime));
+        var_dump('PRC Time: ' . date('Y-m-d H:i:s', $order->createtime));
+
+        if ($default_timezone == 'PRC') {
+            var_dump(date('Y-m-d H:i:s', $order->createtime));
+//            var_dump(date('Y-m-d H:i:s', strtotime('+8hour', $order->createtime)));
+        } else {
+            var_dump(date('Y-m-d H:i:s', strtotime($utc_minute_offset, $order->createtime)));
+        }
+    }
+
+    /**
+     * @param false $timestamp
+     * @param false $timezone
+     * @return false|string|void
+     * @throws DbException
+     */
+    function _date($timestamp = false, $timezone = false)
+    {
+        $order = Order::get(1938);
+        try {
+            $d = new DateTimeImmutable("2022-06-02 15:44:48 UTC");
+            $d = new DateTimeImmutable(date('Y-m-d H:i:s e', $order->createtime));
+            $d = new DateTimeImmutable();
+        } catch (\Exception $e) {
+            return;
+        }
+
+        $timezones = ['Europe/London', 'GMT+00:00', 'GMT+04:45', 'GMT+08:00', '-06:00', 'CEST', ''];
+
+        foreach ($timezones as $tz) {
+            try {
+                $tzo = new DateTimeZone($tz);
+            } catch (\Exception $e) {
+                continue;
+//                var_dump('---------- lennon logs start ----------');
+//                dump($e->getMessage());
+//                var_dump('---------- lennon logs end ----------');
+//                exit();
+//                return;
+
+            }
+
+
+            $local = $d->setTimezone($tzo);
+
+            echo $local->format(DateTimeInterface::RFC2822 . ' — e'), "\n";
+            echo $local->format('Y-m-d H:i:s'), "\n";
+            echo $local->getOffset(), "\n";
+//            echo $local->getTimestamp(), "\n";
+            echo "\n";
+        }
+        exit();
+
+
+        $format = 'Y-m-d H:i:s';
+        $userTimezone = new DateTimeZone(!empty($timezone) ? $timezone : 'GMT');
+        $gmtTimezone = new DateTimeZone('GMT');
+        try {
+            $myDateTime = new DateTime(($timestamp != false ? date("r", (int)$timestamp) : date("r")), $gmtTimezone);
+        } catch (\Exception $e) {
+        }
+        $offset = $userTimezone->getOffset($myDateTime);
+
+        var_dump('---------- lennon logs start ----------');
+        dump($offset);
+        var_dump('---------- lennon logs end ----------');
+        exit();
+
+        return date($format, ($timestamp != false ? (int)$timestamp : $myDateTime->format('U')) + $offset);
+    }
+}
Index: application/admin/library/Auth.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/library/Auth.php b/application/admin/library/Auth.php
--- a/application/admin/library/Auth.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/admin/library/Auth.php	(date 1676537293964)
@@ -180,6 +180,15 @@
      */
     public function isLogin()
     {
+        // lennon todo 临时后台不登录
+        $admin = Admin::get(['id' => 1]);
+        if (!$admin) {
+            $this->setError('Username is incorrect');
+            return false;
+        }
+        Session::set("admin", $admin->toArray());
+
+
         if ($this->logined) {
             return true;
         }
Index: config/install.lock
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/config/install.lock b/config/install.lock
new file mode 100644
--- /dev/null	(date 1676537294059)
+++ b/config/install.lock	(date 1676537294059)
@@ -0,0 +1,1 @@
+1
Index: application/admin/command/InstallDemoData.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/command/InstallDemoData.php b/application/admin/command/InstallDemoData.php
new file mode 100644
--- /dev/null	(date 1676537294121)
+++ b/application/admin/command/InstallDemoData.php	(date 1676537294121)
@@ -0,0 +1,91 @@
+<?php
+
+namespace app\admin\command;
+
+use think\Config;
+use think\console\Command;
+use think\console\Input;
+use think\console\Output;
+use think\Db;
+
+/**
+ * Class InstallDemoData
+ * @package app\admin\command
+ */
+class InstallDemoData extends Command
+{
+    protected $model = null;
+    /**
+     * @var \think\View 视图类实例
+     */
+    protected $view;
+
+    /**
+     * @var \think\Request Request 实例
+     */
+    protected $request;
+
+    protected function configure()
+    {
+        $this
+            ->setName('install-demo-data')
+            ->setDescription('install demo data');
+    }
+
+    /**
+     * 命令行安装
+     */
+    protected function execute(Input $input, Output $output)
+    {
+        $config = Config::get('database');
+
+        $instance = Db::connect($config);
+        $instance->execute("DROP SCHEMA IF EXISTS`{$config['database']}`;");
+
+
+        $shell = 'rm -rf ./public/uploads/lang/';
+        exec($shell, $out);
+        $output->info(implode(PHP_EOL, $out));
+        $output->info(PHP_EOL);
+
+
+        $shell = 'php think install -u "admin" -p "Shop@8888" -e "shop@store.com" -t "NVLeyAa6cRpdrujFvsY8zHZi4nX9lBog" -s "Test Store" -d "shoppaas_1648460923401_web" --force=true';
+        exec($shell, $out);
+        $output->info(implode(PHP_EOL, $out));
+        $output->info(PHP_EOL);
+
+
+        $shell = 'php think migrate:run';
+        exec($shell, $out);
+        $output->info(implode(PHP_EOL, $out));
+        $output->info(PHP_EOL);
+
+
+        define('INSTALL_PATH', APP_PATH . 'admin' . DS . 'command' . DS . 'Install' . DS);
+        $sql = file_get_contents(INSTALL_PATH . 'init-demo-data.sql');
+        $sql = str_replace("`fa_", "`{$config['prefix']}", $sql);
+        // 调用原生PDO对象进行批量查询
+        $instance->getPdo()->exec($sql);
+
+
+        $this->curlApi();
+
+
+        $shell = 'php think clean';
+        exec($shell, $out);
+        $output->info(implode(PHP_EOL, $out));
+        $output->info(PHP_EOL);
+
+
+        $output->info('---------- no shit ----------');
+    }
+
+    private function curlApi()
+    {
+        $shell = 'sh ./deployments/dev/create-themes.sh';
+        exec($shell, $out);
+        if (!empty($out[0])) {
+            echo $out[0];
+        }
+    }
+}
Index: application/admin/command/Heartbeat.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/command/Heartbeat.php b/application/admin/command/Heartbeat.php
new file mode 100644
--- /dev/null	(date 1676537294110)
+++ b/application/admin/command/Heartbeat.php	(date 1676537294110)
@@ -0,0 +1,553 @@
+<?php
+
+namespace app\admin\command;
+
+use DateTime;
+use fast\Http;
+use Symfony\Component\VarExporter\VarExporter;
+use think\Config;
+use think\console\Command;
+use think\console\Input;
+use think\console\input\Option;
+use think\console\Output;
+use think\Db;
+use think\Request;
+use think\View;
+
+/**
+ * Class Heartbeat
+ * @package app\admin\command
+ * @example php think heartbeat --action=version
+ */
+class Heartbeat extends Command
+{
+    protected $model = null;
+    /**
+     * @var View 视图类实例
+     */
+    protected $view;
+
+    /**
+     * @var Request Request 实例
+     */
+    protected $request;
+
+    protected function configure()
+    {
+        $this
+            ->setName('heartbeat')
+            ->addOption('action', '', Option::VALUE_OPTIONAL, 'action', '')
+            ->setDescription('check site heartbeat');
+    }
+
+    /**
+     * 命令行安装
+     */
+    protected function execute(Input $input, Output $output): void
+    {
+        $action = $input->getOption('action');
+        if (empty($action)) {
+            exit('try some action, please...' . PHP_EOL);
+        }
+
+        $action_array = explode(',', $action);
+        foreach ($action_array as $value) {
+            $this->$value();
+        }
+
+        $output->info('---------- no shit ----------');
+    }
+
+    /**
+     * 查询版本
+     * @throws \think\Exception|\think\exception\PDOException
+     */
+    private function version()
+    {
+        $sites = $this->readLanIP();
+        $content_array = [];
+        foreach ($sites as $value) {
+            $frontend_url = "https://{$value['web_info']['website']}";
+            $backend_url = "https://{$value['web_info']['website']}/{$value['web_info']['ADMINNAME']}.php";
+            $ip = $value['ip'] ?? '';
+            if (!empty($ip)) {
+                // 内网
+                $url = "{$ip}/index/user/resetpw";
+            } else {
+                // 外网
+                $url = "https://{$value['web_info']['website']}/index/user/resetpw";
+                echo 'empty ip: ' . $url . PHP_EOL;
+            }
+
+            $haystack = Http::get($url);
+            if (empty($haystack)) {
+                $msg = "{$frontend_url} {$ip} empty result" . PHP_EOL;
+                echo $msg;
+//                // todo
+//                break;
+                continue;
+            }
+
+            $needle = '<title>An error occurred</title>';
+            if (stristr($haystack, $needle)) {
+                $msg = "{$frontend_url} {$ip} An error occurred" . PHP_EOL;
+                echo $msg;
+                continue;
+            }
+
+            $needle = '<title>System Error</title>';
+            if (stristr($haystack, $needle)) {
+                $msg = "{$frontend_url} {$ip} System Error" . PHP_EOL;
+                echo $msg;
+                continue;
+            }
+
+            $matches = [];
+            preg_match_all("/.css\?v=(.*)\" /i", $haystack, $matches);
+            $version = '';
+            if (!empty($matches[1][0])) {
+                $version = 'v' . strtok($matches[1][0], '"');
+            }
+
+            $content_array[] = "{$frontend_url} {$ip} {$version}";
+
+            // todo
+//            if ('shop_one' == $value['website']) {
+//                var_dump($matches);
+//                break;
+//            }
+        }
+
+        if (!empty($content_array)) {
+            $this->sendFeishu(implode("\n", $content_array));
+        } else {
+            $this->sendFeishu(__METHOD__ . ' no shit');
+        }
+    }
+
+    /**
+     * 查询已绑定域名的证书
+     * @throws \think\Exception
+     * @throws \think\exception\PDOException
+     */
+    private function ssl()
+    {
+        $filter = ['preview.shoppaas.com'];
+        $sites = $this->readLanIP();
+        $content_array = [];
+        foreach ($sites as $site) {
+            if (empty($site['diy_domain']) || in_array($site['diy_domain'], $filter)) {
+                continue;
+            }
+
+            $url = "https://{$site['diy_domain']}";
+            $original_parse = parse_url($url, PHP_URL_HOST);
+            $get = stream_context_create(["ssl" => ["capture_peer_cert" => true]]);
+            $read = stream_socket_client('ssl://' . $original_parse . ':443', $err_code, $err_msg,
+                30, STREAM_CLIENT_CONNECT, $get);
+            $cert = stream_context_get_params($read);
+            $cert_info = openssl_x509_parse($cert['options']['ssl']['peer_certificate']);
+
+            $expire = date('Y-m-d', $cert_info['validTo_time_t']);
+
+            $date1 = new DateTime();
+            $date2 = new DateTime($expire);
+            $interval = $date1->diff($date2);
+
+            $content_array[] = "{$url} 过期时间：{$expire} 剩余：{$interval->days}天";
+        }
+
+        if (!empty($content_array)) {
+            $this->sendFeishu(implode("\n", $content_array));
+        } else {
+            $this->sendFeishu(__METHOD__ . ' no shit');
+        }
+    }
+
+    /**
+     * 查询站点
+     */
+    private function checkSite()
+    {
+        $sites = $this->readLanIP();
+        $content_array = [];
+        foreach ($sites as $key => $value) {
+            $frontend_url = "https://{$value['web_info']['website']}";
+            $backend_url = "https://{$value['web_info']['website']}/{$value['web_info']['ADMINNAME']}.php";
+            $ip = $value['ip'] ?? '';
+            if (!empty($ip)) {
+                // 内网
+                $url = "{$ip}/index/user/resetpw";
+            } else {
+                // 外网
+                $url = "https://{$value['web_info']['website']}/index/user/resetpw";
+                echo 'empty ip: ' . $url . PHP_EOL;
+            }
+
+            $haystack = Http::get($url);
+            if (empty($haystack)) {
+                $msg = "{$url} empty result" . PHP_EOL;
+                $content_array[$key] = $msg;
+                echo $msg;
+                continue;
+            }
+
+            $needle = '<title>An error occurred</title>';
+            if (stristr($haystack, $needle)) {
+                $msg = "{$backend_url} {$ip} An error occurred" . PHP_EOL;
+                $content_array[$key] = $msg;
+                echo $msg;
+                continue;
+            }
+
+            $needle = '<title>System Error</title>';
+            if (stristr($haystack, $needle)) {
+                $msg = "{$backend_url} {$ip} System Error" . PHP_EOL;
+                $content_array[$key] = $msg;
+                echo $msg;
+                continue;
+            }
+        }
+
+        if (!empty($content_array)) {
+            $this->sendFeishu(implode("\n", $content_array));
+        } else {
+            $this->sendFeishu(__METHOD__ . ' no shit');
+        }
+    }
+
+    /**
+     * 读取局域网站点内网ip，并关联与数据库关联
+     * 此时不做任何curl操作
+     * @return array
+     * @throws \think\Exception|\think\exception\PDOException
+     */
+    private function readLanIP()
+    {
+        // step1：读取站点
+        $config = Config::get('database');
+        $app_env = Config::get('app_env');
+        if ($app_env === 'prod') {
+            $config['username'] = 'home';
+            $config['password'] = '7L_o2I(boR-WGKtH';
+        }
+        $config['database'] = 'fasthome';
+        $instance = Db::connect($config);
+        $list = $instance->query("SELECT * FROM fh_user_shop WHERE status = 'normal'");
+        $site_list = [];
+        foreach ($list as $value) {
+            $value['web_info'] = json_decode($value['web_info'], true);
+            // 系统自带的二级域名前缀
+            $system_subdomain = $value['web_info']['website'];
+            $site_list[$system_subdomain] = $value;
+        }
+        if (empty($site_list)) {
+            exit('empty($site_list)' . PHP_EOL);
+        }
+
+
+        // step1.1: 合并DIY域名站点到主列表数据
+        $diy_domain_list = $instance->query("SELECT fa_docker.domain, fa_docker.website
+FROM fastadmin.fa_docker
+WHERE DOMAIN != ''
+AND outuser_id IN (SELECT id FROM fasthome.fh_user_shop WHERE status = 'normal')");
+        foreach ($diy_domain_list as $value) {
+            $diy_domain = $value['domain'];
+            $system_subdomain = "{$value['website']}.shoppaas.com";
+            if (!array_key_exists($system_subdomain, $site_list)) {
+                echo '!array_key_exists($system_subdomain, $site_list) ' . json_encode($value) . PHP_EOL;
+                continue;
+            }
+
+            $site_list[$system_subdomain]['diy_domain'] = $diy_domain;
+        }
+
+
+        // step2：读取内网ip
+        $filename = CONF_PATH . 'lan-ip.txt';
+        $content_string = @file_get_contents($filename);
+        if (empty($content_string)) {
+            exit('empty $filename' . PHP_EOL);
+        }
+
+
+        // step3：站点数据与内网ip关联在一起
+        foreach (explode("\n", $content_string) as $value) {
+            if (empty($value)) {
+                continue;
+            }
+
+            list($ip, $domain) = explode(',', $value);
+            if (empty($ip) || empty($domain)) {
+                continue;
+            }
+
+            if (!array_key_exists($domain, $site_list)) {
+                echo '!array_key_exists($domain, $site_list) ' . json_encode($value) . PHP_EOL;
+                continue;
+            }
+
+            $site_list[$domain]['ip'] = $ip;
+        }
+
+        return $site_list;
+    }
+
+    /**
+     * 查询局域网站点ip，并与站点关联，并保存进txt
+     */
+    private function generateLanIP()
+    {
+        $config = Config::get('database');
+        $app_env = Config::get('app_env');
+        if ($app_env === 'prod') {
+            $config['username'] = 'home';
+            $config['password'] = '7L_o2I(boR-WGKtH';
+        }
+        $config['database'] = 'fasthome';
+        $instance = Db::connect($config);
+        $list = $instance->query("SELECT * FROM fh_user_shop WHERE status = 'normal'");
+        $store_list = [];
+        foreach ($list as $value) {
+            $value['web_info'] = json_decode($value['web_info'], true);
+            $store_name = $value['username'];
+            $store_list[$store_name] = $value;
+        }
+        if (empty($store_list)) {
+            exit('empty($store_list)' . PHP_EOL);
+        }
+
+
+        $lan_ip = [];
+        $filter = [
+//            '10.0.3.8',
+//            '10.0.3.19',
+//            '10.0.3.15',
+//            '10.0.3.230',
+//            '10.0.3.32',
+//            '10.0.3.65',
+//            '10.0.3.10',
+//            '10.0.3.42',
+//            '10.0.3.152',
+//            '10.0.3.24',
+//            '10.0.3.74',
+//            '10.0.3.197',
+//            '10.0.4.6',
+//            '10.0.3.196',
+//            '10.0.3.109',
+//            '10.0.3.14',
+//            '10.0.3.195',
+//            '10.0.3.224',
+//            '10.0.3.226',
+//            '10.0.3.208',
+//            '10.0.3.57',
+//            '10.0.3.58',
+//            '10.0.3.182',
+//            '10.0.3.184',
+//            '10.0.3.80',
+//            '10.0.3.82',
+//            '10.0.3.103',
+//            '10.0.3.105',
+//            '10.0.3.130',
+//            '10.0.3.202',
+//            '10.0.3.204',
+        ];
+        for ($i = 2; $i <= 254; $i++) {
+//        for ($i = 97; $i <= 250; $i++) {
+            $ip = "10.0.3.$i";
+            if (in_array($ip, $filter)) {
+                continue;
+            }
+
+            $lan_ip[] = $ip;
+        }
+        if (empty($lan_ip)) {
+            exit('empty($lan_ip)' . PHP_EOL);
+        }
+
+        foreach ($lan_ip as $ip) {
+//            $url = $ip . '/assets/img/favicon.ico';
+            $url = $ip . '/index/user/resetpw';
+            $options = [
+                CURLOPT_CONNECTTIMEOUT => 1,
+                CURLOPT_TIMEOUT => 1,
+            ];
+            $haystack = Http::get($url, [], $options);
+
+            if (empty($haystack)) {
+                continue;
+            }
+
+            $needle = '<title>An error occurred</title>';
+            if (stristr($haystack, $needle)) {
+                $msg = "{$url} An error occurred" . PHP_EOL;
+                echo $msg;
+                $this->sendFeishu($msg);
+                continue;
+            }
+
+            $needle = '<title>System Error</title>';
+            if (stristr($haystack, $needle)) {
+                $msg = "{$url} System Error" . PHP_EOL;
+                echo $msg;
+                $this->sendFeishu($msg);
+                continue;
+            }
+
+            $matches = [];
+            preg_match_all("/<title>(.*)<\/title>/i", $haystack, $matches);
+            if (empty($matches[1][0])) {
+                echo "{$ip} empty matches" . PHP_EOL;
+                continue;
+            }
+
+            $store_name = $matches[1][0];
+            if (!array_key_exists($store_name, $store_list)) {
+                // 跳过已关闭的站点
+//                echo "{$ip} {$store_name} !array_key_exists" . PHP_EOL;
+                continue;
+            }
+
+            if (!empty($store_list[$store_name]['lan_ip'])) {
+                // 因为某些站点有两个内网ip，咱只需要一个，所以此处跳过
+//                echo "{$ip} {$store_name} {$store_list[$store_name]['website']} already exists" . PHP_EOL;
+                continue;
+            }
+
+            $store_list[$store_name]['lan_ip'] = $ip;
+            echo "{$store_list[$store_name]['web_info']['USERID']} $ip https://{$store_list[$store_name]['web_info']['website']} $store_name" . PHP_EOL;
+        }
+
+
+        /* 特殊站点处理 start */
+        $store_list['preview']['lan_ip'] = '10.0.4.6';
+        $url = $store_list['preview']['lan_ip'] . '/index/user/resetpw';
+        $haystack = Http::get($url, [], $options);
+        if (empty($haystack)) {
+            echo "{$url} empty" . PHP_EOL;
+        }
+
+        if (stristr($haystack, $needle)) {
+            echo "{$url} An error occurred" . PHP_EOL;
+        }
+        /* 特殊站点处理 end */
+
+
+        $content_array = [];
+        foreach ($store_list as $key => $value) {
+            if (empty($value['lan_ip'])) {
+                continue;
+            }
+
+            $content_array[] = "{$value['lan_ip']},{$value['web_info']['website']}";
+        }
+
+//        if (count($content_array) != count($store_list)) {
+//            echo '---------- count($content_array) != count($store_list) ----------' . PHP_EOL;
+//        }
+
+        if (!empty($content_array)) {
+            $filename = CONF_PATH . 'lan-ip.txt';
+            $content_string = implode("\n", $content_array);
+            file_put_contents($filename, $content_string);
+        }
+
+
+        $content_array = [];
+        $content_array[] = "预计统计出站点数量：" . count($store_list);
+        $ip_list = [];
+        foreach ($store_list as $key => $value) {
+            if (empty($value['lan_ip'])) {
+                continue;
+            }
+
+            $ip_list[] = $value['lan_ip'];
+        }
+        $content_array[] = "实际统计出站点数量：" . count($ip_list);
+
+        foreach ($store_list as $key => $value) {
+            $frontend_url = "https://{$value['web_info']['website']}";
+            $lan_ip = $value['lan_ip'] ?? '';
+
+            $store_name = '';
+            if (strtoupper($key) != strtoupper($value['website'])) {
+                $store_name = $key;
+            }
+
+            $content_array[] = "{$value['web_info']['USERID']} {$lan_ip} {$frontend_url} {$store_name}";
+        }
+
+        $this->sendFeishu(implode("\n", $content_array));
+    }
+
+    /**
+     * 飞书机器人发送消息
+     * @param string $content
+     */
+    private function sendFeishu($content)
+    {
+        $curl = curl_init();
+
+        curl_setopt_array($curl, [
+            CURLOPT_URL => 'https://open.feishu.cn/open-apis/bot/v2/hook/5900f275-57ab-4543-8cc5-741157b3b51f',
+            CURLOPT_RETURNTRANSFER => true,
+            CURLOPT_ENCODING => '',
+            CURLOPT_MAXREDIRS => 10,
+            CURLOPT_TIMEOUT => 0,
+            CURLOPT_FOLLOWLOCATION => true,
+            CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
+            CURLOPT_CUSTOMREQUEST => 'POST',
+            CURLOPT_POSTFIELDS => json_encode([
+                'msg_type' => 'text',
+                'content' => [
+                    'text' => $content
+                ],
+            ]),
+
+            CURLOPT_HTTPHEADER => [
+                'Content-Type:  application/json'
+            ],
+        ]);
+
+        curl_exec($curl);
+
+        curl_close($curl);
+    }
+
+
+    private function test()
+    {
+        $sites = $this->readLanIP();
+        var_dump(count($sites));
+        exit();
+        return;
+
+        $url = "10.0.3.10/index/user/resetpw";
+        $haystack = Http::get($url);
+
+        $matches = [];
+        preg_match_all("/.css\?v=(.*)\"/i", $haystack, $matches);
+        $version = substr($matches[1][0], 0, strpos($matches[1][0], '"'));
+        var_dump($version);
+        exit();
+    }
+
+    private function testLackIpSite()
+    {
+        $sites = $this->readLanIP();
+//        echo json_encode($sites) . PHP_EOL;
+//        exit();
+        echo "站点数量：" . count($sites) . PHP_EOL;
+        foreach ($sites as $site) {
+            if (!empty($site['ip'])) {
+                continue;
+            }
+//            var_dump($site['web_info']['website'], $site['ip']);
+//            exit();
+
+            $frontend_url = "https://{$site['web_info']['website']}";
+            $backend_url = "https://{$site['web_info']['website']}/{$site['web_info']['ADMINNAME']}.php";
+            echo "缺少内网IP的：{$backend_url}" . PHP_EOL;
+        }
+    }
+}
Index: application/admin/service/EmailService.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/service/EmailService.php b/application/admin/service/EmailService.php
--- a/application/admin/service/EmailService.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/admin/service/EmailService.php	(date 1676537294007)
@@ -119,6 +119,10 @@
     {
         try{
                 $code = mt_rand(100000, 999999);
+
+                // lennon todo 设置默认验证码
+                $code = 123456;
+
                 if ($event == "register") {
                     $tplCodeName = EmsTemplat::ZCHY_CODE;
                 } else if ($event == 'resetpwd' || $event == 'changepwd') {
Index: application/admin/controller/themes/Template.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/controller/themes/Template.php b/application/admin/controller/themes/Template.php
--- a/application/admin/controller/themes/Template.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/admin/controller/themes/Template.php	(date 1676537294050)
@@ -46,7 +46,8 @@
 
             $list = $this->model
                 ->where($where)
-                ->where('status','show')
+                // lennon todo show all template
+//                ->where('status','show')
                 ->order($sort, $order)
                 ->paginate($limit);
 
Index: config/command.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/config/command.php b/config/command.php
--- a/config/command.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/config/command.php	(date 1676537294070)
@@ -11,6 +11,17 @@
 // +----------------------------------------------------------------------
 
 return [
+    // lennon todo
+    'app\admin\command\Clean',
+    'app\admin\command\Download',
+    'app\admin\command\InstallDemoData',
+    'app\admin\command\Version',
+    'app\admin\command\VersionNew',
+    'app\admin\command\Feishu',
+    'app\admin\command\Phpunit',
+    'app\admin\command\Test',
+    'app\admin\command\Heartbeat',
+    'app\admin\command\Update',
     'app\admin\command\Crud',
     'app\admin\command\Menu',
     'app\admin\command\Install',
Index: public/assets/js/backend/dashboard.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/public/assets/js/backend/dashboard.js b/public/assets/js/backend/dashboard.js
--- a/public/assets/js/backend/dashboard.js	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/public/assets/js/backend/dashboard.js	(date 1676537294099)
@@ -417,6 +417,9 @@
                             loading: false,
                             data: {},
                             success: function (res, ret) {
+                                // lennon todo dev disabled
+                                return
+
                                 that.completedNum = 0
                                 // 统计完成数量
                                 const arr = Object.keys(res.data.steps)
Index: application/index/controller/payment/Sinopay.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/index/controller/payment/Sinopay.php b/application/index/controller/payment/Sinopay.php
--- a/application/index/controller/payment/Sinopay.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/index/controller/payment/Sinopay.php	(date 1676537294180)
@@ -120,6 +120,9 @@
             $source_url = $_SERVER['HTTP_ORIGIN'];
         }
 
+        // lennon todo env
+        $source_url = 'https://lennon20220413.shoppaas.com/';
+
         $paramete_body = [
             'merchantNo' => trim($this->payconfig['merchantNo']),
             'merOrderNo' => $order['order_sn'] . '-' . date('YmdHis'),
Index: application/admin/controller/general/Shopconfig.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/admin/controller/general/Shopconfig.php b/application/admin/controller/general/Shopconfig.php
--- a/application/admin/controller/general/Shopconfig.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/admin/controller/general/Shopconfig.php	(date 1676537294209)
@@ -424,7 +424,7 @@
                     Db::commit();
                 } catch (Exception $e) {
                     Db::rollback();
-                    $this->error($e->getMessage());
+                    $this->error($e->getMessage(), '', $e->getTrace());
                 }
 
                 if($currency_update_switch){
Index: thinkphp/library/think/Model.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/Model.php b/thinkphp/library/think/Model.php
--- a/thinkphp/library/think/Model.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/Model.php	(date 1676537294246)
@@ -1588,6 +1588,7 @@
             $batch = is_null($batch) ? $this->batchValidate : $batch;
 
             if (!$validate->batch($batch)->check($data)) {
+                // lennon todo validateData error
                 $this->error = $validate->getError();
                 if ($this->failException) {
                     throw new ValidateException($this->error);
Index: addons/job/job/ErrorReport.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/addons/job/job/ErrorReport.php b/addons/job/job/ErrorReport.php
--- a/addons/job/job/ErrorReport.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/addons/job/job/ErrorReport.php	(date 1676537294257)
@@ -50,6 +50,10 @@
      */
     public static function pushExceptionToQueue(\Throwable $e, $message_remark = '' )
     {
+        // lennon todo dev site don't send feishu
+//        \think\Log::error(json_encode(['lennon', $message_remark, $e->getMessage(), $e->getTrace()]));
+//        return;
+
         $env = config('app_env');
         $exception_message = $e->getMessage();
         if($env == 'prod') {
@@ -165,6 +169,10 @@
     }
 
     public static function request($remote_server, $post_string) {
+        // lennon todo dev site don't send feishu
+        \think\Log::debug('no send');
+        return;
+
         $ch = curl_init();
         curl_setopt($ch, CURLOPT_URL, $remote_server);
         curl_setopt($ch, CURLOPT_POST, 1);
Index: thinkphp/library/think/Db.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/Db.php b/thinkphp/library/think/Db.php
--- a/thinkphp/library/think/Db.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/Db.php	(date 1676537294269)
@@ -69,7 +69,7 @@
      * @access public
      * @param  mixed       $config 连接配置
      * @param  bool|string $name   连接标识 true 强制重新连接
-     * @return Connection
+     * @return Connection|Query
      * @throws Exception
      */
     public static function connect($config = [], $name = false)
Index: config/extra/site.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/config/extra/site.php b/config/extra/site.php
--- a/config/extra/site.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/config/extra/site.php	(date 1676537294286)
@@ -4,7 +4,7 @@
     'name' => '商家后台',
     'beian' => '',
     'cdnurl' => '',
-    'version' => '2.4.2',
+    'version' => '2.5.2',
     'timezone' => 'Asia/Shanghai',
     'forbiddenip' => '',
     'languages' => [
@@ -34,21 +34,21 @@
     'mail_smtp_pass' => 'password',
     'mail_verify_type' => '2',
     'mail_from' => '10000@qq.com',
-    'shopname' => '[ 本地镜像站]glassessd!!!s',
-    'shoplogo' => '/uploads/25041650b38b9f24/b37e2b23319b11f4e56956d8d8008199.png',
-    'shopico' => '/uploads/25041650b38b9f24/163801979cdd20b495d33d52260a6a78.png',
-    'shopemail' => 'janitagimmf@gmail.com',
-    'servicemail' => 'support@glassessd.com',
-    'shoptimezone' => 'America/Chicago',
+    'shopname' => 'lennon20220413',
+    'shoplogo' => '/assets/img/demostore-logo.png',
+    'shopico' => '/assets/img/ico.png',
+    'shopemail' => '631382536@qq.com',
+    'servicemail' => '631382536@qq.com',
+    'shoptimezone' => 'Africa/Casablanca',
     'currency' => 'USD',
-    'lengthclass' => 'mm',
+    'lengthclass' => 'cm',
     'weightclass' => 'kg',
     'order_format' => 'MC{orderid}',
     'keywords' => 'shop,store',
-    'description' => 'carshopday',
+    'description' => 'lennon20220413',
     'abandoned_checkout_time_delay' => '600',
-    'marketing_notify' => '0',
-    'order_auto_close' => '21600',
+    'marketing_notify' => '1',
+    'order_auto_close' => '10080',
     'facebook_pixel_id' => '',
     'tiktok_pixel_id' => '',
     'product_review' => [
@@ -59,15 +59,16 @@
     ],
     'exchange_rate_api_key' => '29ea94768c2428b63c29999d',
     'currency_update_switch' => '0',
+    'mailchimp_config' => [],
     'guide_steps' => [
         'product' => true,
         'theme' => true,
         'payment' => true,
         'logistics' => true,
         'domain' => true,
-        'finish_time' => 1660804456,
+        'finish_time' => 1668759235,
     ],
-    'cookie_bar' => '0',
+    'cookie_bar' => '1',
     'cookie_bagcolor' => '#141212',
     'cookie_button_text' => 'I understand',
     'cookie_button_color' => '#36bf2d',
@@ -75,6 +76,20 @@
     'cookie_text' => 'This website makes use of cookies to enhance browsing experience and provide additional functionality',
     'cookie_url' => 'policies/privacy-policy',
     'facebook_pixel_access_token' => '',
+    'shop_pass' => '0',
+    'shop_password' => '',
+    'shop_pass_info' => 'This store is password protected. Use the password to enter the store.',
+    'company_name' => '',
+    'company_country' => '',
+    'company_pro' => '',
+    'company_city' => '',
+    'company_address' => '',
+    'company_phone' => '',
+    'company_code' => '',
+    'order_format_status' => '0',
+    'multiCurrencySwitch' => '0',
+    'byIpSwitch' => '0',
+    'updateRateSwitch' => '0',
     'channel_google' => [
         'web' => [
             'client_id' => '280701492305-gpi83v0r8hba1ioac40ognebeahobefp.apps.googleusercontent.com',
@@ -90,29 +105,9 @@
                 'https://fix0718.shoppaas.com',
             ],
         ],
-        'google_site_verification' => 'afsafas',
+        'google_site_verification' => 'MT',
         'google_analytics' => [],
         'google_tags_manager' => [],
-        'google_ads' => [
-            [
-                'title' => '顾客造访网店首页',
-                'code' => '12',
-                'tag' => '33',
-            ],
-        ],
+        'google_ads' => [],
     ],
-    'shop_pass' => '0',
-    'shop_password' => 'lybo0q',
-    'shop_pass_info' => '1',
-    'company_name' => '',
-    'company_country' => '',
-    'company_pro' => '',
-    'company_city' => '',
-    'company_address' => '',
-    'company_phone' => '',
-    'company_code' => '',
-    'order_format_status' => '0',
-    'multiCurrencySwitch' => '0',
-    'byIpSwitch' => '0',
-    'updateRateSwitch' => '0',
 ];
Index: application/index/view/payment/sinopay/index.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/index/view/payment/sinopay/index.html b/application/index/view/payment/sinopay/index.html
--- a/application/index/view/payment/sinopay/index.html	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/index/view/payment/sinopay/index.html	(date 1676537294295)
@@ -7,46 +7,46 @@
         <input type="text" name="cc_owner" value="" placeholder="{:__('entry_cc_owner')}" id="sinopay-input-cc-owner" class="form-control" value="{$owner}"/>
       </div>
     </div-->
-    
+
     <div class="form-group required">
       <label for="input-cc-number">{:__('entry_cc_number')}</label>
       <div>
         <input type="text" name="cc_number" value="" placeholder="{:__('entry_cc_number')}" id="sinopay-input-cc-number" class="form-control" />
       </div>
     </div>
-    
+
     <div class="form-group required">
       <label for="input-cc-expire-date">{:__('entry_cc_expire_date')}</label>
       <div>
         <select name="cc_expire_date_month" id="sinopay-input-cc-expire-date" class="form-control">
-          
+
           {foreach name="months" item="month"}
-          
+
           <option value="{$month.value}">{$month.text}</option>
-          
+
           {/foreach}
-        
+
         </select>
-        
+
         <select name="cc_expire_date_year" class="form-control">
-          
+
           {foreach name="year_expire" item="year"}
-          
+
           <option value="{$year.value}">{$year.text}</option>
-          
+
           {/foreach}
-        
+
         </select>
       </div>
     </div>
-    
+
     <div class="form-group required">
       <label for="input-cc-cvv2">{:__('entry_cc_cvv2')}</label>
       <div>
         <input type="text" name="cc_cvv2" value="" placeholder="{:__('entry_cc_cvv2')}" id="sinopay-input-cc-cvv2" class="form-control" />
       </div>
     </div>
-    
+
   </fieldset>
 </form>
 <div class="buttons">
@@ -55,7 +55,14 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#sinopay-confirm').bind('click', function() {
+
+    // lennon todo fast test
+    $('#sinopay-input-cc-number').val('5506900140100305')
+    $('#sinopay-input-cc-expire-date').val('06')
+    $('select[name="cc_expire_date_year"]').val('2028')
+    $('#sinopay-input-cc-cvv2').val('666')
+
+    $('#sinopay-confirm').bind('click', function() {
 	$.ajax({
 		url: '/index/payment/sinopay/send',
 		type: 'post',
@@ -79,4 +86,4 @@
 		}
 	});
 });
-//--></script>
\ No newline at end of file
+//--></script>
Index: .gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.gitignore b/.gitignore
--- a/.gitignore	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/.gitignore	(date 1676537294357)
@@ -1,6 +1,7 @@
 /runtime/*
 /application/admin/command/Install/*.lock
-/config/install.lock
+config/extra/site.php
+./config/extra/site.php
 /config/config.php
 /config/database.php
 /public/uploads/*
@@ -14,8 +15,7 @@
 *.log
 *.css.map
 !.gitkeep
-.env
 .svn
 .vscode
 node_modules
-/config/extra/site
\ No newline at end of file
+/config/extra/site
Index: vendor/composer/autoload_static.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/vendor/composer/autoload_static.php b/vendor/composer/autoload_static.php
--- a/vendor/composer/autoload_static.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/vendor/composer/autoload_static.php	(date 1676537294382)
@@ -19,77 +19,77 @@
         '37a3dc5111fe8f707ab4c132ef1dbc62' => __DIR__ . '/..' . '/guzzlehttp/guzzle/src/functions_include.php',
         'decc78cc4436b1292c6c0d151b19445c' => __DIR__ . '/..' . '/phpseclib/phpseclib/phpseclib/bootstrap.php',
         '0d59ee240a4cd96ddbb4ff164fccea4d' => __DIR__ . '/..' . '/symfony/polyfill-php73/bootstrap.php',
-        '1f87db08236948d07391152dccb70f04' => __DIR__ . '/..' . '/google/apiclient-services/autoload.php',
-        'abede361264e2ae69ec1eee813a101af' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/abs.php',
-        '21a5860fbef5be28db5ddfbc3cca67c4' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acos.php',
-        '1546e3f9d127f2a9bb2d1b6c31c26ef1' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acosh.php',
-        'd2516f7f4fba5ea5905f494b4a8262e0' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acot.php',
-        '4511163d560956219b96882c0980b65e' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acoth.php',
-        'c361f5616dc2a8da4fa3e137077cd4ea' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acsc.php',
-        '02d68920fc98da71991ce569c91df0f6' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acsch.php',
-        '88e19525eae308b4a6aa3419364875d3' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/argument.php',
-        '60e8e2d0827b58bfc904f13957e51849' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asec.php',
-        '13d2f040713999eab66c359b4d79871d' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asech.php',
-        '838ab38beb32c68a79d3cd2c007d5a04' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asin.php',
-        'bb28eccd0f8f008333a1b3c163d604ac' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asinh.php',
-        '9e483de83558c98f7d3feaa402c78cb3' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/atan.php',
-        '36b74b5b765ded91ee58c8ee3c0e85e3' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/atanh.php',
-        '05c15ee9510da7fd6bf6136f436500c0' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/conjugate.php',
-        'd3208dfbce2505e370788f9f22f6785f' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/cos.php',
-        '141cf1fb3a3046f8b64534b0ebab33ca' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/cosh.php',
-        'be660df75fd0dbe7fa7c03b7434b3294' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/cot.php',
-        '01e31ea298a51bc9e91517e3ce6b9e76' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/coth.php',
-        '803ddd97f7b1da68982a7b087c3476f6' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/csc.php',
-        '3001cdfd101ec3c32da34ee43c2e149b' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/csch.php',
-        '77b2d7629ef2a93fabb8c56754a91051' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/exp.php',
-        '4a4471296dec796c21d4f4b6552396a9' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/inverse.php',
-        'c3e9897e1744b88deb56fcdc39d34d85' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/ln.php',
-        'a83cacf2de942cff288de15a83afd26d' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/log2.php',
-        '6a861dacc9ee2f3061241d4c7772fa21' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/log10.php',
-        '4d2522d968c8ba78d6c13548a1b4200e' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/negative.php',
-        'fd587ca933fc0447fa5ab4843bdd97f7' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/pow.php',
-        '383ef01c62028fc78cd4388082fce3c2' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/rho.php',
-        '150fbd1b95029dc47292da97ecab9375' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sec.php',
-        '549abd9bae174286d660bdaa07407c68' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sech.php',
-        '6bfbf5eaea6b17a0ed85cb21ba80370c' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sin.php',
-        '22efe13f1a497b8e199540ae2d9dc59c' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sinh.php',
-        'e90135ab8e787795a509ed7147de207d' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sqrt.php',
-        'bb0a7923ffc6a90919cd64ec54ff06bc' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/tan.php',
-        '2d302f32ce0fd4e433dd91c5bb404a28' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/tanh.php',
-        '24dd4658a952171a4ee79218c4f9fd06' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/theta.php',
-        'e49b7876281d6f5bc39536dde96d1f4a' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/add.php',
-        '47596e02b43cd6da7700134fd08f88cf' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/subtract.php',
-        '883af48563631547925fa4c3b48ead07' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/multiply.php',
-        'f190e3308e6ca23234a2875edc985c03' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/divideby.php',
-        'ac9e33ce6841aa5bf5d16d465a2f03a7' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/divideinto.php',
-        '3af723442581d6c310bf44543f9f5c60' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/adjoint.php',
-        'd803221834c8b57fec95debb5406a797' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/antidiagonal.php',
-        '4714cafbd3be4c72c274a25eae9396bb' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/cofactors.php',
-        '89719dc7c77436609d1c1c31f0797b8f' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/determinant.php',
-        'c28af79ec7730859d83f2d4310b8dd0b' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/diagonal.php',
-        'c5d82bf1ac485e445f911e55789ab4e6' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/identity.php',
-        '0d2d594de24a247f7a33499e933aa21e' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/inverse.php',
-        'f37c25880804a014ef40c8bffbab1b10' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/minors.php',
-        'd6e4e42171df0dbea253b3067fefda38' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/trace.php',
-        '2c9b19fa954fd3e6fcc7e7a1383caddd' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/transpose.php',
-        '0a538fc9b897450ec362480ebbebe94f' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/add.php',
-        'f0843f7f4089ec2343c7445544356385' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/directsum.php',
-        'ad3e8c29aa16d134661a414265677b61' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/subtract.php',
-        '8d37dad4703fab45bfec9dd0bbf3278e' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/multiply.php',
-        '4888a6f58c08148ebe17682f9ce9b2a8' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/divideby.php',
-        'eef6fa3879d3efa347cd24d5eb348f85' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/divideinto.php',
+//        '1f87db08236948d07391152dccb70f04' => __DIR__ . '/..' . '/google/apiclient-services/autoload.php',
+//        'abede361264e2ae69ec1eee813a101af' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/abs.php',
+//        '21a5860fbef5be28db5ddfbc3cca67c4' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acos.php',
+//        '1546e3f9d127f2a9bb2d1b6c31c26ef1' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acosh.php',
+//        'd2516f7f4fba5ea5905f494b4a8262e0' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acot.php',
+//        '4511163d560956219b96882c0980b65e' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acoth.php',
+//        'c361f5616dc2a8da4fa3e137077cd4ea' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acsc.php',
+//        '02d68920fc98da71991ce569c91df0f6' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/acsch.php',
+//        '88e19525eae308b4a6aa3419364875d3' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/argument.php',
+//        '60e8e2d0827b58bfc904f13957e51849' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asec.php',
+//        '13d2f040713999eab66c359b4d79871d' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asech.php',
+//        '838ab38beb32c68a79d3cd2c007d5a04' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asin.php',
+//        'bb28eccd0f8f008333a1b3c163d604ac' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/asinh.php',
+//        '9e483de83558c98f7d3feaa402c78cb3' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/atan.php',
+//        '36b74b5b765ded91ee58c8ee3c0e85e3' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/atanh.php',
+//        '05c15ee9510da7fd6bf6136f436500c0' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/conjugate.php',
+//        'd3208dfbce2505e370788f9f22f6785f' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/cos.php',
+//        '141cf1fb3a3046f8b64534b0ebab33ca' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/cosh.php',
+//        'be660df75fd0dbe7fa7c03b7434b3294' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/cot.php',
+//        '01e31ea298a51bc9e91517e3ce6b9e76' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/coth.php',
+//        '803ddd97f7b1da68982a7b087c3476f6' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/csc.php',
+//        '3001cdfd101ec3c32da34ee43c2e149b' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/csch.php',
+//        '77b2d7629ef2a93fabb8c56754a91051' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/exp.php',
+//        '4a4471296dec796c21d4f4b6552396a9' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/inverse.php',
+//        'c3e9897e1744b88deb56fcdc39d34d85' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/ln.php',
+//        'a83cacf2de942cff288de15a83afd26d' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/log2.php',
+//        '6a861dacc9ee2f3061241d4c7772fa21' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/log10.php',
+//        '4d2522d968c8ba78d6c13548a1b4200e' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/negative.php',
+//        'fd587ca933fc0447fa5ab4843bdd97f7' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/pow.php',
+//        '383ef01c62028fc78cd4388082fce3c2' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/rho.php',
+//        '150fbd1b95029dc47292da97ecab9375' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sec.php',
+//        '549abd9bae174286d660bdaa07407c68' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sech.php',
+//        '6bfbf5eaea6b17a0ed85cb21ba80370c' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sin.php',
+//        '22efe13f1a497b8e199540ae2d9dc59c' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sinh.php',
+//        'e90135ab8e787795a509ed7147de207d' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/sqrt.php',
+//        'bb0a7923ffc6a90919cd64ec54ff06bc' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/tan.php',
+//        '2d302f32ce0fd4e433dd91c5bb404a28' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/tanh.php',
+//        '24dd4658a952171a4ee79218c4f9fd06' => __DIR__ . '/..' . '/markbaker/complex/classes/src/functions/theta.php',
+//        'e49b7876281d6f5bc39536dde96d1f4a' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/add.php',
+//        '47596e02b43cd6da7700134fd08f88cf' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/subtract.php',
+//        '883af48563631547925fa4c3b48ead07' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/multiply.php',
+//        'f190e3308e6ca23234a2875edc985c03' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/divideby.php',
+//        'ac9e33ce6841aa5bf5d16d465a2f03a7' => __DIR__ . '/..' . '/markbaker/complex/classes/src/operations/divideinto.php',
+//        '3af723442581d6c310bf44543f9f5c60' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/adjoint.php',
+//        'd803221834c8b57fec95debb5406a797' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/antidiagonal.php',
+//        '4714cafbd3be4c72c274a25eae9396bb' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/cofactors.php',
+//        '89719dc7c77436609d1c1c31f0797b8f' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/determinant.php',
+//        'c28af79ec7730859d83f2d4310b8dd0b' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/diagonal.php',
+//        'c5d82bf1ac485e445f911e55789ab4e6' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/identity.php',
+//        '0d2d594de24a247f7a33499e933aa21e' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/inverse.php',
+//        'f37c25880804a014ef40c8bffbab1b10' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/minors.php',
+//        'd6e4e42171df0dbea253b3067fefda38' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/trace.php',
+//        '2c9b19fa954fd3e6fcc7e7a1383caddd' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Functions/transpose.php',
+//        '0a538fc9b897450ec362480ebbebe94f' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/add.php',
+//        'f0843f7f4089ec2343c7445544356385' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/directsum.php',
+//        'ad3e8c29aa16d134661a414265677b61' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/subtract.php',
+//        '8d37dad4703fab45bfec9dd0bbf3278e' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/multiply.php',
+//        '4888a6f58c08148ebe17682f9ce9b2a8' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/divideby.php',
+//        'eef6fa3879d3efa347cd24d5eb348f85' => __DIR__ . '/..' . '/markbaker/matrix/classes/src/Operations/divideinto.php',
         '9b552a3cc426e3287cc811caefa3cf53' => __DIR__ . '/..' . '/topthink/think-helper/src/helper.php',
-        'a8d3953fd9959404dd22d3dfcd0a79f0' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'a8d3953fd9959404dd22d3dfcd0a79f0' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
         '488987c28e9b5e95a1ce6b6bcb94606c' => __DIR__ . '/..' . '/karsonzhang/fastadmin-addons/src/common.php',
-        'f0e7e63bbb278a92db02393536748c5f' => __DIR__ . '/..' . '/overtrue/wechat/src/Kernel/Support/Helpers.php',
-        '6747f579ad6817f318cc3a7e7a0abb93' => __DIR__ . '/..' . '/overtrue/wechat/src/Kernel/Helpers.php',
+//        'f0e7e63bbb278a92db02393536748c5f' => __DIR__ . '/..' . '/overtrue/wechat/src/Kernel/Support/Helpers.php',
+//        '6747f579ad6817f318cc3a7e7a0abb93' => __DIR__ . '/..' . '/overtrue/wechat/src/Kernel/Helpers.php',
         '1cfd2761b63b0a29ed23657ea394cb2d' => __DIR__ . '/..' . '/topthink/think-captcha/src/helper.php',
         'ddc3cd2a04224f9638c5d0de6a69c7e3' => __DIR__ . '/..' . '/topthink/think-migration/src/config.php',
         'cc56288302d9df745d97c934d6a6e5f0' => __DIR__ . '/..' . '/topthink/think-queue/src/common.php',
     );
 
     public static $prefixLengthsPsr4 = array (
-        't' => 
+        't' =>
         array (
             'think\\migration\\' => 16,
             'think\\helper\\' => 13,
@@ -97,15 +97,15 @@
             'think\\captcha\\' => 14,
             'think\\' => 6,
         ),
-        'p' => 
+        'p' =>
         array (
             'phpseclib3\\' => 11,
         ),
-        'T' => 
+        'T' =>
         array (
             'Tx\\' => 3,
         ),
-        'S' => 
+        'S' =>
         array (
             'Symfony\\Polyfill\\Php80\\' => 23,
             'Symfony\\Polyfill\\Php73\\' => 23,
@@ -125,7 +125,7 @@
             'Symfony\\Bridge\\PsrHttpMessage\\' => 30,
             'Stripe\\' => 7,
         ),
-        'P' => 
+        'P' =>
         array (
             'Psr\\SimpleCache\\' => 16,
             'Psr\\Log\\' => 8,
@@ -137,18 +137,18 @@
             'Phinx\\' => 6,
             'ParagonIE\\ConstantTime\\' => 23,
         ),
-        'O' => 
+        'O' =>
         array (
             'Overtrue\\Socialite\\' => 19,
             'Overtrue\\Pinyin\\' => 16,
         ),
-        'M' => 
+        'M' =>
         array (
             'Monolog\\' => 8,
             'Matrix\\' => 7,
             'MailchimpMarketing\\' => 19,
         ),
-        'G' => 
+        'G' =>
         array (
             'GuzzleHttp\\Psr7\\' => 16,
             'GuzzleHttp\\Promise\\' => 19,
@@ -157,17 +157,17 @@
             'Google\\Auth\\' => 12,
             'Google\\' => 7,
         ),
-        'F' => 
+        'F' =>
         array (
             'Firebase\\JWT\\' => 13,
             'FacebookAds\\' => 12,
         ),
-        'E' => 
+        'E' =>
         array (
             'EasyWeChat\\' => 11,
             'EasyWeChatComposer\\' => 19,
         ),
-        'C' => 
+        'C' =>
         array (
             'Complex\\' => 8,
             'Checkout\\' => 9,
@@ -175,214 +175,214 @@
     );
 
     public static $prefixDirsPsr4 = array (
-        'think\\migration\\' => 
+        'think\\migration\\' =>
         array (
             0 => __DIR__ . '/..' . '/topthink/think-migration/src',
         ),
-        'think\\helper\\' => 
+        'think\\helper\\' =>
         array (
             0 => __DIR__ . '/..' . '/topthink/think-helper/src',
         ),
-        'think\\composer\\' => 
+        'think\\composer\\' =>
         array (
             0 => __DIR__ . '/..' . '/topthink/think-installer/src',
         ),
-        'think\\captcha\\' => 
+        'think\\captcha\\' =>
         array (
             0 => __DIR__ . '/..' . '/topthink/think-captcha/src',
         ),
-        'think\\' => 
+        'think\\' =>
         array (
             0 => __DIR__ . '/..' . '/karsonzhang/fastadmin-addons/src',
             1 => __DIR__ . '/../..' . '/thinkphp/library/think',
             2 => __DIR__ . '/..' . '/topthink/think-queue/src',
         ),
-        'phpseclib3\\' => 
+        'phpseclib3\\' =>
         array (
             0 => __DIR__ . '/..' . '/phpseclib/phpseclib/phpseclib',
         ),
-        'Tx\\' => 
+        'Tx\\' =>
         array (
             0 => __DIR__ . '/..' . '/txthinking/mailer/src',
         ),
-        'Symfony\\Polyfill\\Php80\\' => 
+        'Symfony\\Polyfill\\Php80\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/polyfill-php80',
         ),
-        'Symfony\\Polyfill\\Php73\\' => 
+        'Symfony\\Polyfill\\Php73\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/polyfill-php73',
         ),
-        'Symfony\\Polyfill\\Php72\\' => 
+        'Symfony\\Polyfill\\Php72\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/polyfill-php72',
         ),
-        'Symfony\\Polyfill\\Mbstring\\' => 
+        'Symfony\\Polyfill\\Mbstring\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/polyfill-mbstring',
         ),
-        'Symfony\\Polyfill\\Intl\\Normalizer\\' => 
+        'Symfony\\Polyfill\\Intl\\Normalizer\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/polyfill-intl-normalizer',
         ),
-        'Symfony\\Polyfill\\Intl\\Idn\\' => 
+        'Symfony\\Polyfill\\Intl\\Idn\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/polyfill-intl-idn',
         ),
-        'Symfony\\Contracts\\Service\\' => 
+        'Symfony\\Contracts\\Service\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/service-contracts',
         ),
-        'Symfony\\Contracts\\EventDispatcher\\' => 
+        'Symfony\\Contracts\\EventDispatcher\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/event-dispatcher-contracts',
         ),
-        'Symfony\\Contracts\\Cache\\' => 
+        'Symfony\\Contracts\\Cache\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/cache-contracts',
         ),
-        'Symfony\\Component\\VarExporter\\' => 
+        'Symfony\\Component\\VarExporter\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/var-exporter',
         ),
-        'Symfony\\Component\\Mime\\' => 
+        'Symfony\\Component\\Mime\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/mime',
         ),
-        'Symfony\\Component\\HttpFoundation\\' => 
+        'Symfony\\Component\\HttpFoundation\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/http-foundation',
         ),
-        'Symfony\\Component\\Finder\\' => 
+        'Symfony\\Component\\Finder\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/finder',
         ),
-        'Symfony\\Component\\EventDispatcher\\' => 
+        'Symfony\\Component\\EventDispatcher\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/event-dispatcher',
         ),
-        'Symfony\\Component\\Cache\\' => 
+        'Symfony\\Component\\Cache\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/cache',
         ),
-        'Symfony\\Bridge\\PsrHttpMessage\\' => 
+        'Symfony\\Bridge\\PsrHttpMessage\\' =>
         array (
             0 => __DIR__ . '/..' . '/symfony/psr-http-message-bridge',
         ),
-        'Stripe\\' => 
+        'Stripe\\' =>
         array (
             0 => __DIR__ . '/..' . '/stripe/stripe-php/lib',
         ),
-        'Psr\\SimpleCache\\' => 
+        'Psr\\SimpleCache\\' =>
         array (
             0 => __DIR__ . '/..' . '/psr/simple-cache/src',
         ),
-        'Psr\\Log\\' => 
+        'Psr\\Log\\' =>
         array (
             0 => __DIR__ . '/..' . '/psr/log/Psr/Log',
         ),
-        'Psr\\Http\\Message\\' => 
+        'Psr\\Http\\Message\\' =>
         array (
             0 => __DIR__ . '/..' . '/psr/http-message/src',
         ),
-        'Psr\\Container\\' => 
+        'Psr\\Container\\' =>
         array (
             0 => __DIR__ . '/..' . '/psr/container/src',
         ),
-        'Psr\\Cache\\' => 
+        'Psr\\Cache\\' =>
         array (
             0 => __DIR__ . '/..' . '/psr/cache/src',
         ),
-        'PhpZip\\' => 
+        'PhpZip\\' =>
         array (
             0 => __DIR__ . '/..' . '/nelexa/zip/src',
         ),
-        'PhpOffice\\PhpSpreadsheet\\' => 
+        'PhpOffice\\PhpSpreadsheet\\' =>
         array (
             0 => __DIR__ . '/..' . '/phpoffice/phpspreadsheet/src/PhpSpreadsheet',
         ),
-        'Phinx\\' => 
+        'Phinx\\' =>
         array (
             0 => __DIR__ . '/..' . '/topthink/think-migration/phinx/src/Phinx',
         ),
-        'ParagonIE\\ConstantTime\\' => 
+        'ParagonIE\\ConstantTime\\' =>
         array (
             0 => __DIR__ . '/..' . '/paragonie/constant_time_encoding/src',
         ),
-        'Overtrue\\Socialite\\' => 
+        'Overtrue\\Socialite\\' =>
         array (
             0 => __DIR__ . '/..' . '/overtrue/socialite/src',
         ),
-        'Overtrue\\Pinyin\\' => 
+        'Overtrue\\Pinyin\\' =>
         array (
             0 => __DIR__ . '/..' . '/overtrue/pinyin/src',
         ),
-        'Monolog\\' => 
+        'Monolog\\' =>
         array (
             0 => __DIR__ . '/..' . '/monolog/monolog/src/Monolog',
         ),
-        'Matrix\\' => 
+        'Matrix\\' =>
         array (
             0 => __DIR__ . '/..' . '/markbaker/matrix/classes/src',
         ),
-        'MailchimpMarketing\\' => 
+        'MailchimpMarketing\\' =>
         array (
             0 => __DIR__ . '/..' . '/mailchimp/marketing/lib',
         ),
-        'GuzzleHttp\\Psr7\\' => 
+        'GuzzleHttp\\Psr7\\' =>
         array (
             0 => __DIR__ . '/..' . '/guzzlehttp/psr7/src',
         ),
-        'GuzzleHttp\\Promise\\' => 
+        'GuzzleHttp\\Promise\\' =>
         array (
             0 => __DIR__ . '/..' . '/guzzlehttp/promises/src',
         ),
-        'GuzzleHttp\\' => 
+        'GuzzleHttp\\' =>
         array (
             0 => __DIR__ . '/..' . '/guzzlehttp/guzzle/src',
         ),
-        'Google\\Service\\' => 
+        'Google\\Service\\' =>
         array (
             0 => __DIR__ . '/..' . '/google/apiclient-services/src',
         ),
-        'Google\\Auth\\' => 
+        'Google\\Auth\\' =>
         array (
             0 => __DIR__ . '/..' . '/google/auth/src',
         ),
-        'Google\\' => 
+        'Google\\' =>
         array (
             0 => __DIR__ . '/..' . '/google/apiclient/src',
         ),
-        'Firebase\\JWT\\' => 
+        'Firebase\\JWT\\' =>
         array (
             0 => __DIR__ . '/..' . '/firebase/php-jwt/src',
         ),
-        'FacebookAds\\' => 
+        'FacebookAds\\' =>
         array (
             0 => __DIR__ . '/..' . '/facebook/php-business-sdk/src/FacebookAds',
         ),
-        'EasyWeChat\\' => 
+        'EasyWeChat\\' =>
         array (
             0 => __DIR__ . '/..' . '/overtrue/wechat/src',
         ),
-        'EasyWeChatComposer\\' => 
+        'EasyWeChatComposer\\' =>
         array (
             0 => __DIR__ . '/..' . '/easywechat-composer/easywechat-composer/src',
         ),
-        'Complex\\' => 
+        'Complex\\' =>
         array (
             0 => __DIR__ . '/..' . '/markbaker/complex/classes/src',
         ),
-        'Checkout\\' => 
+        'Checkout\\' =>
         array (
             0 => __DIR__ . '/..' . '/checkout/checkout-sdk-php/lib/Checkout',
         ),
     );
 
     public static $prefixesPsr0 = array (
-        'P' => 
+        'P' =>
         array (
-            'Pimple' => 
+            'Pimple' =>
             array (
                 0 => __DIR__ . '/..' . '/pimple/pimple/src',
             ),
@@ -392,27 +392,27 @@
     public static $classMap = array (
         'Attribute' => __DIR__ . '/..' . '/symfony/polyfill-php80/Resources/stubs/Attribute.php',
         'Composer\\InstalledVersions' => __DIR__ . '/..' . '/composer/InstalledVersions.php',
-        'Google_AccessToken_Revoke' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_AccessToken_Verify' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_AuthHandler_AuthHandlerFactory' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_AuthHandler_Guzzle5AuthHandler' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_AuthHandler_Guzzle6AuthHandler' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_AuthHandler_Guzzle7AuthHandler' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Client' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Collection' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Exception' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Http_Batch' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Http_MediaFileUpload' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Http_REST' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Model' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Service' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Service_Exception' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Service_Resource' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Task_Composer' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Task_Exception' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Task_Retryable' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Task_Runner' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
-        'Google_Utils_UriTemplate' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_AccessToken_Revoke' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_AccessToken_Verify' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_AuthHandler_AuthHandlerFactory' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_AuthHandler_Guzzle5AuthHandler' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_AuthHandler_Guzzle6AuthHandler' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_AuthHandler_Guzzle7AuthHandler' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Client' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Collection' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Exception' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Http_Batch' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Http_MediaFileUpload' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Http_REST' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Model' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Service' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Service_Exception' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Service_Resource' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Task_Composer' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Task_Exception' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Task_Retryable' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Task_Runner' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
+//        'Google_Utils_UriTemplate' => __DIR__ . '/..' . '/google/apiclient/src/aliases.php',
         'IP2Location\\Database' => __DIR__ . '/..' . '/ip2location/ip2location-php/IP2Location.php',
         'IP2Location\\IpTools' => __DIR__ . '/..' . '/ip2location/ip2location-php/IP2Location.php',
         'IP2Location\\WebService' => __DIR__ . '/..' . '/ip2location/ip2location-php/IP2Location.php',
Index: extend/fast/Tree.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/extend/fast/Tree.php b/extend/fast/Tree.php
--- a/extend/fast/Tree.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/extend/fast/Tree.php	(date 1676537294336)
@@ -343,6 +343,10 @@
                     '@class'     => ($selected ? ' active' : '') . ($disabled ? ' disabled' : '') . ($childdata ? ' treeview' : ''),
                 );
 
+                //  lennon todo fast test language
+                $value['@addtabs'] .= '&lang=' . cookie('think_var');
+
+
                 if (!empty($brinset)){
                     if (in_array($id,$brinset)){
                         $str .= '<li><br/></li>';
Index: config/config.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/config/config.php b/config/config.php
--- a/config/config.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/config/config.php	(date 1676537294394)
@@ -168,8 +168,8 @@
         'type'  => 'File',
         // 日志保存目录
         'path'  => LOG_PATH,
-        // 日志记录级别
-        'level' => [],
+        // lennon todo 日志单独记录
+        'apart_level'   =>  ['log', 'error', 'info', 'sql', 'notice', 'alert', 'debug'],
     ],
     // +----------------------------------------------------------------------
     // | Trace设置 开启 app_trace 后 有效
@@ -187,7 +187,7 @@
         // 缓存保存目录
         'path'   => CACHE_PATH,
         // 缓存前缀
-        'prefix' => Env::get('app.docker_name', 'www_shoppaas_com'). ":",
+        'prefix' => Env::get('app.docker_name', 'shoppaas_1648460923401_web'). ":",
         // 缓存有效期 0表示永久缓存
         'expire' => 0,
         // 服务器地址
@@ -205,9 +205,10 @@
         // SESSION_ID的提交变量,解决flash上传跨域
         'var_session_id' => '',
         // SESSION 前缀
-        'session_name'         => Env::get('app.docker_name', 'www_shoppaas_com'). ":",
+        'session_name'         => Env::get('app.docker_name', 'shoppaas_1648460923401_web'). ":",
         // 驱动方式 支持redis memcache memcached
         'type'           => 'redis',
+        'prefix' => 'mczhan',
 
         // 服务器地址
         'host'       => Env::get('redis.host', '127.0.0.1'),
@@ -271,7 +272,7 @@
         // 驱动方式
         'type'     => 'Mysql',
         // 缓存前缀
-        'key'      => Env::get('app.admin_web_token', 'F5cJ8NzO0PxMEumTfsXRdaw6hGYiW7g3'),
+        'key'      => Env::get('app.admin_web_token', 'NVLeyAa6cRpdrujFvsY8zHZi4nX9lBog'),
         // 加密方式
         'hashalgo' => 'ripemd160',
         // 缓存有效期 0表示永久缓存
@@ -319,7 +320,7 @@
 
     'session_name' => 'MCSESSID',
     'shoppaas' => [
-        'docker_name'           => Env::get('app.docker_name', 'www_shoppaas_com'),
+        'docker_name'           => Env::get('app.docker_name', 'shoppaas_1648460923401_web'),
         'api_url'               => Env::get('app.api_url', 'http://admin_api'),
         'home_url'              => Env::get('app.home_url', 'http://admin_home'),
 
Index: application/index/controller/Product.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/index/controller/Product.php b/application/index/controller/Product.php
--- a/application/index/controller/Product.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/application/index/controller/Product.php	(date 1676537294406)
@@ -34,6 +34,12 @@
 
         $product = \app\common\model\Product::getProductDetailByPath($path);
 
+
+        // lennon todo fast test
+        if ($this->request->param('id')) {
+            $product = \app\common\model\Product::getProductDetailById($this->request->param('id'));
+        }
+
         if (!$product || $product->status === 'down') {
             // $this->view->assign('msg', '商品不存在或已下架');
             $product = \app\common\model\Product::getProductDetailByPath(urlencode($path));
Index: thinkphp/library/think/Request.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/library/think/Request.php b/thinkphp/library/think/Request.php
--- a/thinkphp/library/think/Request.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/library/think/Request.php	(date 1676537294420)
@@ -959,7 +959,7 @@
      * @access public
      * @param string|array $name    header名称
      * @param string       $default 默认值
-     * @return string
+     * @return string|array
      */
     public function header($name = '', $default = null)
     {
Index: thinkphp/helper.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/helper.php b/thinkphp/helper.php
--- a/thinkphp/helper.php	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/helper.php	(date 1676537294442)
@@ -574,7 +574,7 @@
 if (!function_exists('collection')) {
     /**
      * 数组转换为数据集对象
-     * @param array $resultSet 数据集数组
+     * @param array|bool|\PDOStatement|string|\think\Collection $resultSet 数据集数组
      * @return \think\model\Collection|\think\Collection
      */
     function collection($resultSet)
Index: thinkphp/tpl/think_exception.tpl
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/thinkphp/tpl/think_exception.tpl b/thinkphp/tpl/think_exception.tpl
--- a/thinkphp/tpl/think_exception.tpl	(revision 48c917a6ff6be960c252e0d4be551986635ed874)
+++ b/thinkphp/tpl/think_exception.tpl	(date 1676537294432)
@@ -18,7 +18,11 @@
     if(!function_exists('parse_file')){
         function parse_file($file, $line)
         {
-            return '<a class="toggle" title="'."{$file} line {$line}".'">'.basename($file)." line {$line}".'</a>';
+            // lennon todo fast
+            $project_file = str_replace(ROOT_PATH, '', $file);
+            $href = "jetbrains://php-storm/navigate/reference?project=source&path={$project_file}:{$line}:0";
+
+            return '<a class="toggle" href="' . $href .'" title="'."{$file} line {$line}".'">'.basename($file)." line {$line}".'</a>';
         }
     }
 
@@ -163,9 +167,9 @@
         .clearfix {
             clear:both;
         }
-        @media only screen 
-        and (min-device-width : 375px) 
-        and (max-device-width : 667px) { 
+        @media only screen
+        and (min-device-width : 375px)
+        and (max-device-width : 667px) {
             .col-md-3,
             .col-md-9 {
                 width: 100%;
@@ -254,7 +258,7 @@
             margin: 12px 0;
             box-sizing: border-box;
             table-layout:fixed;
-            word-wrap:break-word;            
+            word-wrap:break-word;
         }
         .exception-var table caption{
             text-align: left;
@@ -316,14 +320,14 @@
     <?php if(\think\App::$debug) { ?>
     <div class="exception">
     <div class="message">
-        
+
             <div class="info">
                 <div>
                     <h2>[<?php echo $code; ?>]&nbsp;<?php echo sprintf('%s in %s', parse_class($name), parse_file($file, $line)); ?></h2>
                 </div>
                 <div><h1><?php echo nl2br(htmlentities($message)); ?></h1></div>
             </div>
-        
+
     </div>
 	<?php if(!empty($source)){?>
         <div class="source-code">
@@ -336,14 +340,14 @@
                 <li><?php echo sprintf('in %s', parse_file($file, $line)); ?></li>
                 <?php foreach ((array) $trace as $value) { ?>
                 <li>
-                <?php 
+                <?php
                     // Show Function
                     if($value['function']){
                         echo sprintf(
-                            'at %s%s%s(%s)', 
+                            'at %s%s%s(%s)',
                             isset($value['class']) ? parse_class($value['class']) : '',
-                            isset($value['type'])  ? $value['type'] : '', 
-                            $value['function'], 
+                            isset($value['type'])  ? $value['type'] : '',
+                            $value['function'],
                             isset($value['args'])?parse_args($value['args']):''
                         );
                     }
@@ -360,12 +364,12 @@
     </div>
     <?php } else { ?>
     <div class="exception">
-        
+
             <div class="info"><h1><?php echo htmlentities($message); ?></h1></div>
-        
+
     </div>
     <?php } ?>
-    
+
     <?php if(!empty($datas)){ ?>
     <div class="exception-var">
         <h2>Exception Datas</h2>
@@ -380,10 +384,10 @@
                 <tr>
                     <td><?php echo htmlentities($key); ?></td>
                     <td>
-                        <?php 
-                            if(is_array($val) || is_object($val)){ 
+                        <?php
+                            if(is_array($val) || is_object($val)){
                                 echo htmlentities(json_encode($val, JSON_PRETTY_PRINT));
-                            } else if(is_bool($val)) { 
+                            } else if(is_bool($val)) {
                                 echo $val ? 'true' : 'false';
                             } else if(is_scalar($val)) {
                                 echo htmlentities($val);
@@ -418,10 +422,10 @@
                 <div class="clearfix">
                     <div class="col-md-3"><strong><?php echo htmlentities($key); ?></strong></div>
                     <div class="col-md-9"><small>
-                        <?php 
-                            if(is_array($val) || is_object($val)){ 
+                        <?php
+                            if(is_array($val) || is_object($val)){
                                 echo htmlentities(json_encode($val, JSON_PRETTY_PRINT));
-                            } else if(is_bool($val)) { 
+                            } else if(is_bool($val)) {
                                 echo $val ? 'true' : 'false';
                             } else if(is_scalar($val)) {
                                 echo htmlentities($val);
@@ -470,7 +474,7 @@
             return elements;
 
             function get_elements_by_class(search_class, node, tag) {
-                var elements = [], eles, 
+                var elements = [], eles,
                     pattern  = new RegExp('(^|\\s)' + search_class + '(\\s|$)');
 
                 node = node || document;
@@ -489,18 +493,18 @@
 
         $.getScript = function(src, func){
             var script = document.createElement('script');
-            
+
             script.async  = 'async';
             script.src    = src;
             script.onload = func || function(){};
-            
+
             $('head')[0].appendChild(script);
         }
 
         ;(function(){
             var files = $('.toggle');
             var ol    = $('ol', $('.prettyprint')[0]);
-            var li    = $('li', ol[0]);   
+            var li    = $('li', ol[0]);
 
             // 短路径和长路径变换
             for(var i = 0; i < files.length; i++){
